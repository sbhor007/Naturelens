<div
  class="max-w-6xl mx-auto mb-8 bg-white min-lg::h-[79vh] rounded-3xl shadow-[0_8px_32px_rgba(0,0,0,0.08)] flex flex-col lg:flex-row overflow-hidden"
>
  <!-- Image Section -->
  <div class="lg:w-3/5 flex items-center justify-center bg-white/20  ">
    <img
      [src]="photo.image"
      alt="Photo"
      class=" shadow-2xl w-full max-h-[75vh] object-contain transition-transform duration-300 hover:scale-[1.01]"
    />
  </div>

  <!-- Content Section -->
  <div class="lg:w-2/5 flex flex-col p-8 gap-6 ">
    <!-- Title & Description -->
    <div class="border-b border-gray-100 pb-2 ">
      <h2 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-3 line-clamp-2 ">
        {{ photo.title }}
      </h2>
      <p class="text-gray-600 text-sm lg:text-base leading-relaxed mb-3 line-clamp-3">
        {{ photo.description }}
      </p>
      
      <!-- Action Buttons -->
      <div class="flex items-start gap-2">
        <!-- Like Button -->
        <button
          class="flex items-center gap-2 px-4 py-2.5 rounded-full  cursor-pointer transition-all duration-200 group"
          (click)="isLikeOrDislike({ photo: photo.id })"
          [attr.aria-pressed]="isLiked"
        >
          <div
            class="flex items-center justify-center w-9 h-9 rounded-full transition-all duration-200"
            [ngClass]="{ 
              'bg-red-50 scale-110': isLiked, 
              'bg-gray-100 group-hover:bg-red-50 group-hover:scale-105': !isLiked 
            }"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 32 32"
              class="transition-all duration-200"
            >
              <path
                [attr.fill]="isLiked ? '#ef4444' : '#6b7280'"
                class="transition-colors duration-200"
                d="M21.081,6C23.752,6.031,26,8.766,26,12c0,5.106-6.47,10.969-10.001,13.593C12.466,22.974,6,17.12,6,12c0-3.234,2.248-5.969,4.918-6C13.586,6.175,13.926,6.801,16,8.879C18.069,6.806,18.418,6.173,21.081,6 M20.911,4.006L20.912,4C18.993,4,17.259,4.785,16,6.048C14.741,4.785,13.007,4,11.088,4l0.001,0.006C7.044,3.936,4,7.719,4,12c0,8,11.938,16,11.938,16h0.124C16.062,28,28,20,28,12C28,7.713,24.951,3.936,20.911,4.006z"
              />
            </svg>
          </div>
          <span class="font-medium text-gray-700 text-sm">{{ totalLikes }}</span>
        </button>

        <!-- Share Button -->
        <button
          class="flex items-center gap-2 px-4 py-2.5 rounded-full  cursor-pointer transition-all duration-200 group"
          title="Share"
        >
          <div class="flex items-center justify-center w-9 h-9 rounded-full bg-gray-100 group-hover:bg-blue-50 group-hover:scale-105 transition-all duration-200">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              class="text-gray-600 group-hover:text-blue-600 transition-colors duration-200"
            >
              <path
                d="M9 6L12 3M12 3L15 6M12 3V13M7.00023 10C6.06835 10 5.60241 10 5.23486 10.1522C4.74481 10.3552 4.35523 10.7448 4.15224 11.2349C4 11.6024 4 12.0681 4 13V17.8C4 18.9201 4 19.4798 4.21799 19.9076C4.40973 20.2839 4.71547 20.5905 5.0918 20.7822C5.5192 21 6.07899 21 7.19691 21H16.8036C17.9215 21 18.4805 21 18.9079 20.7822C19.2842 20.5905 19.5905 20.2839 19.7822 19.9076C20 19.4802 20 18.921 20 17.8031V13C20 12.0681 19.9999 11.6024 19.8477 11.2349C19.6447 10.7448 19.2554 10.3552 18.7654 10.1522C18.3978 10 17.9319 10 17 10"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </div>
          <span class="font-medium text-gray-700 text-sm">1255</span>
        </button>

        <!-- Comment Button -->
         <label for="comment">
        <button
          class="flex items-center gap-2 px-4 py-2.5 rounded-full  cursor-pointer transition-all duration-200 group"
          title="Comments"
        >
          <div class="flex items-center justify-center w-9 h-9 rounded-full bg-gray-100 group-hover:bg-indigo-50 group-hover:scale-105 transition-all duration-200">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              class="text-gray-600 group-hover:text-indigo-600 transition-colors duration-200"
            >
              <path
                d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                fill="currentColor"
              />
            </svg>
          </div>
          <span class="font-medium text-gray-700 text-sm">{{ comments.length }}</span>
        </button>
        </label>
      </div>
    </div>

    <!-- Comments Section -->
    <div class="flex flex-col flex-1 min-h-0 ">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Comments</h3>
      
      <!-- Comments List -->
      <div 
        class="flex-1 overflow-y-auto space-y-4 pr-2 max-h-64 w-full sm:max-h-80 md:max-h-96 lg:max-h-[30vh] custom-scrollbar scroll-smooth"
        style="scroll-behavior: smooth;"
      >
        @for (comment of comments; track $index) {
        <div class="bg-gray-50 rounded-2xl p-4 hover:bg-gray-100 transition-colors duration-200">
          <div class="flex items-start gap-3">
            <!-- Avatar -->
            <div class="w-8 h-8 bg-gradient-to-br from-indigo-100 to-indigo-200 rounded-full flex-shrink-0 flex items-center justify-center">
              <svg class="w-4 h-4 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
            </div>
            
            <!-- Content -->
            <div class="flex-1 min-w-0">
              <!-- Header -->
              <div class="flex items-center justify-between mb-2">
                <div class="flex items-center md:flex-row flex-col gap-2 min-w-0">
                  <span class="font-medium text-gray-900 text-sm truncate">
                    {{ comment.user.first_name }} {{ comment.user.last_name }}
                  </span>
                  <span class="text-xs text-gray-500  w-full md:w-auto">
                    {{ comment.updated_at | date : "MMM dd" }}
                  </span>
                </div>
                
                <!-- Actions for comment owner -->
                 
                @if (comment.user.username == username) {
                <div class="flex items-center gap-1 opacity-70 group-hover:opacity-100 transition-opacity duration-200">
                  <button
                    class="p-1.5 rounded-lg hover:bg-white transition-colors duration-200 group cursor-pointer"
                    title="Edit Comment"
                    (click)="editComment(comment.id,comment.comment)"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="14"
                      height="14"
                      fill="none"
                      viewBox="0 0 24 24"
                      class="text-gray-500 group-hover:text-indigo-600 transition-colors duration-200"
                    >
                      <path
                        d="M4 21h17M18.5 2.5a2.121 2.121 0 0 1 3 3L7 20.5H4v-3L18.5 2.5Z"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </button>
                  
                  <button
                    class="p-1.5 rounded-lg hover:bg-white transition-colors duration-200 group cursor-pointer"
                    title="Delete Comment"
                    (click)="deleteComment(comment.id, photo.id)"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="14"
                      height="14"
                      fill="none"
                      viewBox="0 0 24 24"
                      class="text-gray-500 group-hover:text-red-600 transition-colors duration-200"
                    >
                      <path
                        d="M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2m2 0v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6h16Z"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                      <path
                        d="M10 11v6M14 11v6"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </button>
                </div>
                }
              </div>

              <!-- Comment Text or Edit Form -->
              <div *ngIf="isDisable === false && commentId === comment.id; else showCommentText">
                <form
                  [formGroup]="updateCommentForm"
                  (ngSubmit)="updateComment(comment?.id, comment?.photo, photo?.user?.id)"
                >
                  <div class="relative">
                    <textarea
                      formControlName="message"
                      class="w-full outline-none bg-white text-gray-800 text-sm resize-none overflow-y-auto p-3 pr-10 rounded-xl border border-gray-200 focus:border-indigo-300 focus:ring-2 focus:ring-indigo-100 transition-all duration-200 placeholder-gray-400"
                      rows="2"
                      placeholder="Edit your comment..."
                      style="
                        overflow-wrap: break-word;
                        word-break: break-word;
                        min-height: 2.5rem;
                      "
                    ></textarea>
                    
                    <button
                      class="absolute right-2 bottom-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full p-1.5 transition-all duration-200 transform hover:scale-105"
                      type="submit"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="12"
                        height="12"
                        fill="none"
                        viewBox="0 0 24 24"
                      >
                        <path
                          d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"
                          fill="currentColor"
                        />
                      </svg>
                    </button>
                  </div>
                </form>
              </div>
              
              <ng-template #showCommentText>
                <div class="text-gray-700 text-sm leading-relaxed">
                  {{ comment.comment }}
                </div>
              </ng-template>
            </div>
          </div>
        </div>
        }
      </div>
      
      <!-- Add Comment Form -->
      <form [formGroup]="commentForm" (ngSubmit)="createComment(photo.id)" class="mt-4">
        <div class="flex items-center gap-3 p-4 bg-gray-50 rounded-2xl">
          <div class="w-8 h-8 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full flex-shrink-0 flex items-center justify-center">
            <svg class="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
          </div>
          <input
          id="comment"
            type="text"
            placeholder="Add a comment..."
            formControlName="comment"
            class="flex-1 px-4 py-2.5 bg-white border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-100 focus:border-indigo-300 transition-all duration-200 text-sm placeholder-gray-500"
          />
          <button
            type="submit"
            class="bg-indigo-600 text-white px-6 py-2.5 rounded-xl font-medium shadow-sm hover:bg-indigo-700 hover:shadow-md transition-all duration-200 text-sm cursor-pointer"
          >
            Post
          </button>
        </div>
      </form>
    </div>
  </div>
</div>